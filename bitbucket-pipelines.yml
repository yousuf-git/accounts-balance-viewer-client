image: node:16.17.0

pipelines:
  default:
    - parallel:
        - step:
            name: 'Install, Test and Build'
            caches:
              - node
            script:
              - npm install
              - apt-get update &&
                wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb &&
                apt install -y ./google-chrome*.deb &&
                export CHROME_BIN=/usr/bin/google-chrome
              - npm run test -- --no-watch --no-progress --browsers=ChromeHeadlessCI
              - npm run build
